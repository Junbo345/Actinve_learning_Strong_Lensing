---
title: "Exploring Determinants of Child Mortality (2022): The Role of Vaccination, Healthcare Spending, and Nutrition"
subtitle: "Findings Reveal Vaccination and Healthcare Spending as Key Drivers of Mortality Reduction"
author: 
  - Junbo Li
thanks: "Code and data are available at: [https://github.com/Junbo345/Mortality_analysis]."
date: today
date-format: long
abstract: "Child mortality has significantly decreased over the past three decades, but progress remains uneven across regions. This study examines the under-five mortality rates of 2022, focusing on the effects of vaccination coverage, health expenditure per capita, and food production indices. Using a Bayesian modeling approach, we found that increased vaccination coverage and healthcare spending significantly reduce child mortality, while food production had no direct impact. These findings underscore the critical need for targeted interventions in high-mortality regions, emphasizing the importance of vaccination programs and healthcare funding in achieving global child survival goals."
format: pdf
number-sections: true
bibliography: references.bib
toc: true
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)

```


# Introduction

Over the past 30 years, advancements in society and technology have significantly reduced global mortality rates, particularly for children under the age of five. The under-five mortality rate declined from 93 deaths per 1,000 live births in 1990 to 37 deaths per 1,000 live births in 2022 [@worldbank]. This progress represents millions of children who now have better chances of survival, marking a substantial achievement in global health.

In this study, we examined the under-five mortality rate for each country in 2022, focusing on three key factors: food production index, DPT vaccine coverage, and per-capita health expenditure. These factors were chosen because they reflect critical components influencing child mortality. Infectious diseases, such as pneumonia, diarrhea, and malaria, remain the leading causes of under-five deaths, and these are directly linked to vaccination coverage and healthcare spending. Similarly, maternal health during childbirth is influenced by healthcare accessibility and quality, which is often tied to national health expenditures [@who2024childmortality]. While food production does not directly address infectious disease or maternal health, it reflects a nation’s ability to meet nutritional needs, which is critical for preventing malnutrition—a major underlying cause of child deaths (add supporting explanation and citation).

Our findings reveal that increasing vaccine coverage and per-capita health expenditures significantly reduce under-five mortality rates. However, the food production index does not exhibit a direct impact, suggesting that its role is mediated by other factors such as distribution systems and food quality. Despite progress in reducing global mortality, the pace of reduction has slowed considerably since 2015, decreasing from an annual rate of 3.8% during the Millennium Development Goal (MDG) era (2000–2015) to 2.1% during the Sustainable Development Goal (SDG) era (2015–2022) [@unicef2022underfive]. In 2022 alone, 4.9 million children under the age of five died, equating to approximately 13,400 deaths per day [@unicef2022underfive].

Furthermore, the distribution of mortality rates under five remains highly uneven. Developed countries such as Canada and the United States report mortality rates as low as 10 per 1,000 live births while developing nations—particularly in sub-Saharan Africa—experience rates exceeding 100 per 1,000 live births (@worldbank). This disparity highlights the urgent need for targeted interventions in high-mortality regions. The factors studied in this paper, such as vaccination and healthcare spending, are actionable and can be effectively improved in these regions through foreign aid and international collaboration.

The remainder of this paper is organized as follows. @sec-data describes the data sources, key variables, and preprocessing steps, including transformations applied to address skewness and improve model validity. @sec-model outlines the modeling approach, including the choice of predictors, justification of the model structure, and Bayesian implementation. @sec-results presents the results of the analysis, highlighting the effects of each predictor on under-five mortality. Finally, @sec-diss discusses the implications of the findings, the limitations of the study, and recommendations for future research and policy interventions aimed at reducing child mortality globally.

## Estimand
The primary estimand of this study is the effect of three predictors—food production index, vaccination coverage (DPT vaccine percentage), and per-capita health expenditure (log-transformed)—on the logarithm of the under-five mortality rate for each country in 2022. This analysis seeks to quantify the extent to which these factors contribute to variations in mortality rates across nations. By addressing these relationships, the study aims to identify potential intervention points for reducing preventable child deaths and achieving progress toward the Sustainable Development Goals for child survival.

# Data {#sec-data}

## Overview Check packages

For this analysis, we combined four data sets all together into one. All these four datasets come from **Worldbank** open data platform [@worldbank]. We employed **R** [@citeR], a coding platform to download, clean, and conduct statistical analysis. Besides, we also utilized R packages **tidyverse** [@tidy], **rstanarm** [@rstanarm], **ggplot2** [@gg], **knitr** [@knitr], **arrow** [@arrow], **here** [@here], and **dpylr** [@dplyr]. The paper is outlined in Git Hub using the starter folder provided in **Telling Stories With Data** [@tellingstories].

## Measurement
	
The analysis in this study relies on four data sets, each collected and prepared by various UN-affiliated organizations. Below, we provide a brief overview of the measurement and transformation processes for these data sets. Detailed descriptions and methodological specifics can be found in @sec-methods.

### Response variable:

**Mortality Rate**: The child mortality rate is estimated by the UN Inter-agency Group for Child Mortality Estimation (IGME). The primary data source is each country's vital registration system. These raw data are then processed using a statistical model developed collaboratively by UN agencies and academic institutions to derive robust mortality rate estimates [@worldbank2024M]. 

### Predictors:

**Food Production Index**: This index, prepared by the Food and Agriculture Organization (FAO) of the United Nations, measures aggregate food production relative to the 2014–2016 baseline period. It is calculated using price-weighted data on agricultural products for each country yearly. [@worldbank_foodindex2024].

**Health Expenditure per Capita**: Data on health expenditure per capita are produced by the World Health Organization (WHO) following the System of Health Accounts 2011 (SHA 2011) framework. This framework tracks all health-related spending in a country over a defined time period [@worldbank_health_expenditure_us]. 

**DPT Vaccine Coverage**: DPT vaccine coverage is jointly estimated by the WHO and UNICEF. This metric reflects the percentage of children aged 12–23 months in each country who have received diphtheria, pertussis (whooping cough), and tetanus (DPT) vaccine. Estimates are derived from reports by vaccine service providers and household surveys of vaccination history [@worldbank_dpt_immunization]. 

## Outcome variables

The response variable in this study is the under-five mortality rate, measured as the number of deaths of children under five years old per 1,000 live births.

The Original data range from 0 to 120, with a peak between 10 and 15 deaths per 1,000 live births (@fig-mor-1). Due to extreme values and significant right skewness, a log transformation was applied to stabilize variance and improve normality. The transformed data range from 2 to 5, with a peak near 3 (@fig-mor-2).

```{r}
#| label: fig-mor
#| fig-cap: Data Analysis for Mortality Rate for children under five of Different Countries
#| fig-subcap: ["Dsitribution of Mortality rate before log tranformation", "Distribution of Mortality rate after log transformation"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2

# Load necessary libraries
library(ggplot2)
library(arrow)

# Read the data
data <- read.csv(file = (here::here('data/01-raw_data/raw_data_Mortality.csv')))

# Create the histogram
ggplot(data, aes(x = SH.DYN.MORT)) +
  geom_histogram(binwidth = 7, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(
    x = "Under-Five Mortality Rate",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title = element_text(size = 12)
  )

analysis_data <- read_parquet(file = (here::here('data/02-analysis_data/analysis_data.parquet')))

# Create the histogram
ggplot(analysis_data, aes(x = Mortality)) +
  geom_histogram(binwidth = 0.3, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(
    x = "Under-Five Mortality Rate",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title = element_text(size = 12)
  )

```


## Predictor variables

The three predictors analyzed are:

**Food Production Index:** 
The Food Production Index measures the relative level of agricultural production for each country, using the 2014–2016 baseline as a reference point [@worldbank]. This index is price-weighted and reflects agricultural productivity across countries. As illustrated in @fig-food-1, the index ranges from 60 to 180, with a mean of around 110 and an approximately normal distribution. Scatter plot analysis in @fig-food-2 reveals a slightly positive linear relationship between the Food Production Index and the log-transformed mortality rate. This suggests that as agricultural production increases, mortality rates tend to rise modestly, a pattern that warrants further exploration in @sec-model.
```{r}
#| label: fig-food
#| fig-cap: Data Analysis of Predictor Food Production Index
#| fig-subcap: ["Counts of Food production index for each country, measured as a basis of 2014-1016", "Relationship of each countries' Food production index VS. Log of Mortality rate"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2

# Load necessary libraries
library(ggplot2)
library(arrow)

analysis_data <- read_parquet(file = (here::here('data/02-analysis_data/analysis_data.parquet')))

# Create the histogram
ggplot(analysis_data, aes(x = Food)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(
    x = "Food Production Index",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title = element_text(size = 12)
  )

ggplot(analysis_data, aes(x = Food, y = Mortality)) +
  geom_point(color = "steelblue", alpha = 0.6) +
  geom_smooth(method = "lm", color = "darkred", fill = "pink", se = TRUE, alpha = 0.3) +
  labs(
    x = "Food Production Index",
    y = "Mortality Rate",
  ) +
  theme_minimal() +
  theme(
    axis.title = element_text(size = 12)
  )
```
**Current Health Expenditure:**
The Current Health Expenditure per Capita captures health spending in US dollars, calculated under the System of Health Accounts (SHA 2011) framework. The raw data range from $0 to $12,000 and exhibit extreme right skewness, as shown in @fig-health-1. To address this, a log transformation was applied, resulting in a normalized range from 0 to 10, with a central tendency near 6 (@fig-health-2). Analysis of the relationship between log-transformed health expenditure and log mortality rate (@fig-health-3) demonstrates a significant negative linear trend, indicating that higher health expenditures are associated with lower mortality rates. This relationship is examined in greater detail in @sec-model.
```{r}
#| label: fig-health
#| fig-cap: Data Analysis of Predictor Current Health Expenditure
#| fig-subcap: ["Counts of each countries' Health Expenditure Per Capita, Measured in US$. Before log transformation", "Counts of each countries' Health Expenditure Per Capita, Measured in US$. After log transformation", "Relationship of each countries' Health Expenditure Per Capita, Measured in US$ VS. Log of Mortality"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2

# Load necessary libraries
library(ggplot2)
library(arrow)
library(knitr)

raw_data <- read.csv(file = (here::here('data/01-raw_data/raw_data_Healthexpense.csv')))

analysis_data <- read_parquet(file = (here::here('data/02-analysis_data/analysis_data.parquet')))

ggplot(raw_data, aes(x = SH.XPD.CHEX.PC.CD)) +
  geom_histogram(binwidth = 500, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(
    x = "Health Expense per capita",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title = element_text(size = 12)
  )

# Create the histogram
ggplot(analysis_data, aes(x = Health_expense)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(
    x = "Log of Health Expense per capita",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title = element_text(size = 12)
  )

ggplot(analysis_data, aes(x = Health_expense, y = Mortality)) +
  geom_point(color = "steelblue", alpha = 0.6) +
  geom_smooth(method = "lm", color = "darkred", fill = "pink", se = TRUE, alpha = 0.3) +
  labs(
    x = "Log of Health Expense per capita",
    y = "Mortality Rate",
  ) +
  theme_minimal() +
  theme(
    axis.title = element_text(size = 12)
  )
```
**DPT Vaccine Coverage:**
DPT vaccine coverage rate reflects the percentage of children aged 12–23 months who received vaccinations against diphtheria, pertussis, and tetanus. Coverage ranges from 30% to 100%, with a left-skewed distribution, as depicted in @fig-DPT-1. Analysis of the association between vaccine coverage and mortality rates (@fig-DPT-2) shows a strong negative relationship, suggesting that increased vaccine coverage is correlated with lower mortality rates. This finding will be explored further in @sec-model.
```{r}
#| label: fig-DPT
#| fig-cap: Data Analysis of Predictor DPT Vaccine Percentage
#| fig-subcap: ["Counts of each countries' DPT vaccine percentage", "Relationship of each countries' DPT Vaccine Percentage VS. Log of Mortality"]
#| echo: false
#| warning: false
#| message: false
#| layout-ncol: 2

# Load necessary libraries
library(ggplot2)
library(arrow)
library(knitr)
library(dplyr)

analysis_data <- read_parquet(file = (here::here('data/02-analysis_data/analysis_data.parquet')))

# Create the histogram
ggplot(analysis_data, aes(x = Vacinne)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(
    x = "DPT vaccine percentage",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.title = element_text(size = 12)
  )

ggplot(analysis_data, aes(x = Vacinne, y = Mortality)) +
  geom_point(color = "steelblue", alpha = 0.6) +
  geom_smooth(method = "lm", color = "darkred", fill = "pink", se = TRUE, alpha = 0.3) +
  labs(
    x = "DPT vaccine percentage",
    y = "Mortality Rate",
  ) +
  theme_minimal() +
  theme(
    axis.title = element_text(size = 12)
  )
```
## Missing Data and Time Inconsistancy {#sec-data-missing}
The health expenditure variable was collected in 2021, while other variables reflect 2022 data. This discrepancy is due to the unavailability of more recent health expenditure data. These 2021 values are assumed to approximate 2022 conditions sufficiently for analysis.

Additionally, some smaller countries lacked complete data and were excluded from the analysis. The implications of these omissions are addressed in @sec-results.



# Model {#sec-model}

Our modeling strategy aims to explore the relationships between DPT vaccine coverage, the food production index, and current health expenditure per capita (in current US$) with the under-five mortality rate across nations. By analyzing these factors, we seek to identify opportunities to improve child health outcomes, particularly in countries with high mortality rates. Supporting background information and diagnostics are provided in [Appendix -@sec-model-details].

## Model set-up

Let $y_i$ be the logarithm of under-five mortality rate for nation $i$. We define the following predictors:

$x_{1i}$: DDT vaccine coverage for nation $i$.
$x_{2i}$: Food production index for nation $i$.
$x_{3i}$: Logarithm of current health expenditure per capita (current US$) for nation $i$.
The model is specified as:

\begin{align} 
y_i \mid \mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
u_i &= \alpha + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} \\
\alpha &\sim \mbox{Normal}(2.5, 1) \\
\beta_1 &\sim \mbox{Normal}(0, 2.5)\\
\beta_2 &\sim \mbox{Normal}(0, 2.5)\\
\beta_3 &\sim \mbox{Normal}(0, 2.5)\\
\sigma &\sim \mbox{Exponential}(1) 
\end{align}
 
We implement this model in R [@citeR] using the rstanarm package [@rstanarm].


### Model justification

A Bayesian multivariate linear model was chosen to capture the relationships between the predictors (DPT vaccine coverage, food production index, and current health expenditure) and the response variable (under-five mortality rate). This choice is supported by observed linear trends between each predictor and response in @sec-data. Logarithmic transformations were applied to the under-five mortality rate and current health expenditure per capita to normalize the distributions and stabilize their linear relationships with the predictors.

Default Bayesian priors were used for the predictors, as they provide a robust starting point. For the intercept term, a \mbox{Normal}(2.5, 1) prior was chosen, reflecting the observed distribution of the response variable (see @sec-data). 

### Model weakness
Several limitations are noted in this model:

1. Skewed Predictor Distribution: The distribution of DPT vaccine coverage is skewed left, which may introduce bias. Despite attempts to address this, an ideal solution remains elusive.

2. Potential Collinearity: While each predictor shows an individual linear relationship with the response variable, interdependencies between predictors may affect model accuracy.

3. Simplified Assumptions: The model assumes linearity and does not capture potential non-linear interactions or regional variations that could influence under-five mortality rates.


# Results {#sec-results}

Our results are summarized in @tbl-modelresults.

## Intercept:
The intercept estimate of 6.643 represents the expected logarithm of the under-five mortality rate when all predictors are held constant at their reference or baseline values (e.g., average food production, average vaccine coverage, and average health expenditure).

## Food Production Index:
The coefficient for the food production index is 0.003, indicating a very slight positive relationship between food production and the under-five mortality rate. This naively suggests that reducing food production could also reduce mortality, which is counter-intuitive.

However, a closer examination of the confidence interval for this predictor shows that it includes 0. This implies that the relationship is not statistically significant, so we conclude that food production is not strongly related to overall under-five mortality rates.

## Vaccine Coverage:
The coefficient for vaccine coverage is -0.013, meaning that for every 1 percentage point increase in vaccine coverage, the logarithm of the under-five mortality rate decreases by 1.3%, holding other variables constant.

## Health Expenditure (Log-Transformed):
The coefficient for the log-transformed health expenditure is -0.529, indicating that a 1% increase in health expenditure per capita is associated with a 0.529 unit decrease in the log of the under-five mortality rate, holding all other predictors constant.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: tbl-modelresults
#| tbl-cap: "Outcome predictors of our model"

#### Load libraries ####
library(tidyverse)
library(rstanarm)
library(knitr)
library(arrow)

#### Load the saved model ####
# Load the saved models
model1 <- readRDS(file = here::here("models/Mortality_Model.rds"))

# Extract a tidy summary of the model
model_summary <- broom.mixed::tidy(model1, effects = "fixed", conf.int = TRUE) %>%
  select(term, estimate, std.error, conf.low, conf.high) %>%
  rename(
    Term = term,
    Estimate = estimate,
    `Std. Error` = std.error,
    `2.5% CI` = conf.low,
    `97.5% CI` = conf.high
  )
# Display the summary table
kable(model_summary, digits = 3)

```





# Discussion {#sec-diss}

## Implications in reducing mortality rate
The UN's Sustainable Development Goal (SDG) 3.2 aims to reduce the mortality rate of children under five to fewer than 25 per 1,000 live births by 2030 [@who2024]. While substantial progress has been achieved, reaching this target within the next six years presents significant challenges. Although global trends indicate a decline in child mortality rates, the pace of this reduction has slowed since 2015 [@who2024]. Moreover, as highlighted in @fig-mor-1, significant disparities persist between countries. Some nations have already surpassed the SDG target, with mortality rates well below the threshold, whereas others—primarily in low-income regions such as sub-Saharan Africa—experience rates four times higher than the target.

To achieve the SDG targets, urgent and focused international collaboration is required. Our findings underscore two critical areas for intervention: vaccine coverage and healthcare spending.

Vaccination programs have a demonstrable and significant impact on reducing child mortality. As shown in @fig-DPT-1, the distribution of DPT vaccine coverage is skewed left, indicating that while most countries maintain adequate immunization rates, certain nations lag considerably behind. WHO’s analysis of DPT vaccine coverage highlights that low-performing countries are concentrated in Africa, the Eastern Mediterranean, and South-East Asia regions [@who_dtp3_coverage]. These countries, predominantly developing nations, often face financial constraints that prevent them from funding vaccines for their newborn populations. Consequently, international aid is crucial to making DPT vaccines accessible and affordable in these regions.

Healthcare spending presents a more complex challenge. It involves multiple factors, including a country’s economic capacity, infrastructure development, and access to healthcare services. Addressing these issues requires sustained, long-term efforts. Developed nations can play a pivotal role by providing financial support, sharing technological advancements, and facilitating knowledge transfer to strengthen healthcare systems in developing countries. Without addressing these systemic challenges, achieving equitable child survival rates will remain an unattainable goal.

## Limitation and next steps
This study has several limitations that should be considered in future research. First, as noted in @sec-data-missing, data from several countries is unavailable. While these nations have minimal populations, excluding them introduces potential biases and raises ethical concerns by overlooking their unique challenges. Second, the most recent data used in this study is from 2022. Access to more current data sets would enable a more accurate and relevant analysis, reflecting recent developments in healthcare and child mortality trends.

Additionally, while this study focused on three primary predictors, the dataset includes other indicators that could potentially enrich the analysis. Unfortunately, many of these indicators suffer from missing or outdated values, limiting their utility. Future research should prioritize data completeness and timeliness to improve model robustness and reliability.

Finally, advanced modeling techniques and the inclusion of additional predictors could yield deeper insights. Future studies should explore innovative models to better capture complex relationships and interactions, offering more nuanced recommendations for policy interventions.


\newpage

\appendix

# Appendix {-}


# Sampling Methodology Overview and Evaluation {#sec-methods}

## Overview

This study explores the relationship between under-five mortality rates and three key predictors: food production index, DPT vaccine coverage, and per capita health expenditure. The under-five mortality rate is derived from a combination of vital registration systems, household surveys (e.g., Demographic and Health Surveys and Multiple Indicator Cluster Surveys), and indirect estimation models developed by UN agencies and collaborating academic institutions [@worldbank2024M]. These data sources aim to address disparities in coverage, particularly in regions where vital registration is incomplete.

The food production index, developed by the Food and Agriculture Organization of the United Nations (FAO), quantifies national agricultural output relative to a baseline period (2014–2016) using official national statistics and supplementary surveys [@worldbank_foodindex2024]. Per capita health expenditure is sourced from the World Health Organization (WHO) using the System of Health Accounts (SHA 2011), which systematically tracks all public and private spending on health services, goods, and infrastructure [@worldbank_health_expenditure_us]. Lastly, DPT vaccine coverage is estimated through a combination of administrative data from immunization service providers and household surveys, reflecting the proportion of children aged 12–23 months who received three doses of the vaccine [@worldbank_dpt_immunization].

## Population sample frame, and sampling approach 

The target population for the response variable, under-five mortality rate, includes all children under the age of five globally in 2022. This metric captures the probability per 1,000 live births that a newborn will die before reaching five years of age, providing a direct measure of child survival across regions and contexts. The predictors each represent distinct populations. The food production index measures agricultural output for entire national populations, reflecting food availability and potential nutritional impacts. Similarly, per capita health expenditure pertains to the entire population within a country, as healthcare spending influences system-wide access and quality. DPT vaccine coverage, by contrast, specifically targets the population of children aged 12–23 months, providing insights into immunization rates and public health outreach.

The sampling frame for each variable aligns with its respective population. Under-five mortality rates rely on vital registration systems, which are designed to record all births and deaths. In regions where these systems are incomplete, surveys and statistical models supplement the data to ensure national representativeness. The food production index uses national agricultural statistics as the primary source, with secondary data from government ministries and international organizations filling gaps [@worldbank_foodindex2024]. For DPT vaccine coverage, data are collected through administrative immunization records verified by household surveys [@worldbank_dpt_immunization]. Per capita health expenditure is derived from national accounts and follows the standardized SHA 2011 framework [@worldbank_health_expenditure_us].

The sampling approach for these variables combines census-based data collection with stratified sampling in regions lacking comprehensive infrastructure. While census methods aim to capture complete population-level data, resource constraints in low- and middle-income countries necessitate reliance on surveys and indirect estimation methods. These approaches use stratification to ensure representativeness while accounting for regional disparities. 

## Strength and weakness

The methodological framework demonstrates several strengths. First, the primary reliance on census-based or near-census-level data ensures comprehensive coverage for most variables. This is particularly evident in high-income regions, where systems such as vital registration achieve over 90% completeness [@WHO2024CRVS]. Second, the use of supplementary data sources, such as surveys or administrative records, mitigates gaps in the primary datasets, enhancing data quality. For instance, the food production index excludes non-nutritive products such as coffee and tea, ensuring a focus on agricultural outputs relevant to nutrition [@worldbank_foodindex2024]. The use of standardized frameworks, such as SHA 2011 for health expenditure, further supports consistency and comparability across countries.

However, notable weaknesses persist. In regions with incomplete infrastructure, such as Sub-Saharan Africa, vital registration systems capture only 44% of deaths, leading to substantial data gaps that require imputation through statistical models [@WHO2024CRVS]. These models rely on assumptions that may not fully reflect local demographic trends, introducing potential biases. Moreover, reliance on household surveys for DPT vaccine coverage and mortality data introduces recall bias, as respondents may inaccurately report past events [@Preston1984AgePattern]. Even census-based data are susceptible to misreporting, undercounting, or misclassification, which can distort results. Furthermore, temporal mismatches among variables (e.g., health expenditure data lagging behind mortality rates) may complicate causal inference and trend analysis. 

# Model details {#sec-model-details}

## Posterior predictive check

We conducted a posterior predictive check to evaluate how well the model predicts under-five mortality rates. @fig-ppcheckandposteriorvsprior-1 illustrates the predictive distribution compared to the observed data. The close alignment between observed and predicted values indicates that the model captures the main trends in the data effectively.

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows that the data significantly updates the prior beliefs for all key parameters. The posterior distributions of predictors—vaccine coverage, health expenditure, and food production index—highlight the robustness of their effects in the model.

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 1
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

analysis_data <- read_parquet(file = here::here("data/02-analysis_data/analysis_data.parquet"))

pp_check(model1) +
  theme_classic() +
  theme(legend.position = "bottom")

posterior_vs_prior(model1) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom") +
  coord_flip()
```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows adequate mixing of the Markov Chain Monte Carlo (MCMC) chains, indicating proper convergence. Additionally, the Rhat values for all parameters (Figure 6b) are below 1.05, further confirming convergence and the reliability of the parameter estimates.

@fig-stanareyouokay-2 is a Rhat plot. It shows no significant patterns, indicating that the model assumptions hold. Additionally, the Bayesian framework effectively quantifies uncertainty, with credible intervals for the predictors providing insight into their respective influences on mortality.

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 1
#| fig-width: 8

plot(model1, "trace")

plot(model1, "rhat")
```



\newpage


# References


